import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

// Get all pages from the "pages" collection
const allPages = await getCollection('pages');

// Filter pages that belong to retirement
const retirementPages = allPages.filter((page) => page.slug.startsWith('retirement/'));

// Format for display
const subdirectories = retirementPages.map((page: any) => {
    const baseName = page.slug.replace('retirement/', '');
    return {
        name: baseName,
        path: `/retirement/${baseName}`
    };
});
---

<Layout title="Retirement in Thailand" description="Explore retirement options in Thailand's beautiful destinations">
    <h1>Retirement in Thailand</h1>

    {
        subdirectories.length > 0 ? (
            <div>
                <h2>Explore Thailand retirement destinations</h2>
                <ul>
                    {subdirectories.map((subdir) => (
                        <li>
                            <a href={subdir.path}>{subdir.name.replace(/-/g, ' ').replace(/\b\w/g, (l: string) => l.toUpperCase())}</a>
                        </li>
                    ))}
                </ul>
            </div>
        ) : (
            <p>No retirement destinations found.</p>
        )
    }
</Layout>
