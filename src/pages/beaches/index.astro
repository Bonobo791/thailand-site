---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import fs from 'node:fs';
import path from 'node:path';

// Get all subdirectories in the thailand/beaches directory
const currentDir = 'src/pages/thailand/beaches';
const allFiles = fs.readdirSync(currentDir, { withFileTypes: true });

// Create a Set to track unique page names (without extensions)
const uniquePages = new Set();
const subdirectories: { name: string; path: string }[] = [];

// First pass: collect all unique base names
allFiles.forEach((dirent) => {
    if (dirent.isDirectory() || (dirent.isFile() && dirent.name !== 'index.astro')) {
        const baseName = dirent.name.replace(/\.(md|astro)$/, '');
        uniquePages.add(baseName);
    }
});

// Second pass: create page entries (only once per unique name)
uniquePages.forEach((baseName) => {
    subdirectories.push({
        name: baseName as string,
        path: `/thailand/beaches/${baseName}`
    });
});
---

<Layout title="Thailand Beaches">
    <h1>Thailand Beaches</h1>

    {
        subdirectories.length > 0 ? (
            <div>
                <h2>Explore Thailand Beaches</h2>
                <ul>
                    {subdirectories.map((subdir) => (
                        <li>
                            <a href={subdir.path}>{subdir.name.replace(/-/g, ' ').replace(/\b\w/g, (l) => l.toUpperCase())}</a>
                        </li>
                    ))}
                </ul>
            </div>
        ) : (
            <p>No beaches found.</p>
        )
    }
</Layout>
